---
title: "Mini-Project 2"
author: "Your Name Here"
date: "October 31, 2017"
output: html_document
---

```{r}
```


## Loading the data

This project is so interesting and relevant to my life! yayy 

```{r, include=FALSE}

load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
library(tidyverse)

```


put tables in a useable format
```{r, warning = FALSE, include = FALSE}

#filtered house_elections
house_filtered <- house_elections %>%
  select(fec_id, general_votes, ge_winner)
house_filtered

#filtered candidates
candidates_filtered <- candidates %>% 
   select(-c(cand_st1, cand_st2, cand_city, cand_state,cand_zip))
candidates_filtered

#filtered contributions
contributions_filtered <- contributions %>% 
  select(cmte_id, name, city, state, zip_code, transaction_dt, transaction_amt, cand_id, other_id)
contributions_filtered

 #filter committees 
committees_filtered <- committees %>% 
  select(cmte_id, cmte_name, cmte_city, cmte_state, cmte_zip, cmte_party_affiliation, cand_id)
committees_filtered
```

merge the nice tables
```{r, warning = FALSE, include = FALSE}
house_filtered2 <- house_filtered %>%
  rename(cand_id = fec_id)
house_filtered2
joined_table <- 
  left_join(candidates_filtered, house_filtered2, by = "cand_id")
complete_table <- left_join(joined_table, contributions_filtered, by = "cand_id")
complete_table
```


view the new table
```{r}
# sorting the complete table

presum_races <- complete_table %>%
  filter(cand_election_yr == "2012", cand_office == "S", cand_office_state == "CA")
presum_races
```
```{r}
plot <- function (candidate) { 
  df_candidate <- data.frame(candidate)
  colnames(df_candidate)[1] <- "cand_name"
  df_candidate$cand_name <- as.character(df_candidate$cand_name)
  
  presum_races3 <- presum_races %>% 
    filter(cand_name %in% candidate)%>% 
    group_by(cand_name)%>% 
    spread( key = transaction_dt, value = transaction_amt, fill = 0)%>% 
    mutate(allcontribute = sum(transaction_amt))%>% 
    presum_races3 <- df_candidate %>% 
      left_join(presum_races3, by = "cand_name")
  
  presum_races3 %>% 
    ggplot(aes(x = transaction_dt, y = allcontribute))+ 
    geom_col()
}
plot("FEINSTEIN, DIANNE")
```

```{r}
presum_races2 <- presum_races %>% 
  filter(cand_office_state == "CA")%>% 
  group_by(cand_name, transaction_dt)%>% 
  mutate(allcontribute = sum(transaction_amt))
presum_races2

```


